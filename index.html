<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ø®Ø±ÙŠØ·Ø© J3an - Ø³ÙƒÙŠÙƒØ¯Ø©</title>

  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    :root{
      --bg:#0b1020;
      --card:#111827;
      --muted:#9ca3af;
      --text:#f9fafb;
      --primary:#22c55e;
      --primary-2:#16a34a;
      --warning:#f59e0b;
      --danger:#ef4444;
      --border:rgba(255,255,255,.08);
    }

    *{box-sizing:border-box}
    html,body{
      margin:0;
      padding:0;
      width:100%;
      height:100%;
      font-family:"Cairo","Tajawal",Arial,sans-serif;
      background:var(--bg);
      color:var(--text);
    }

    #map{
      width:100%;
      height:100vh;
    }

    /* Ø¥Ø²Ø§Ù„Ø© Ø´ÙƒÙ„ DivIcon Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ */
    .leaflet-div-icon{
      background:transparent !important;
      border:none !important;
    }

    /* Popup */
    .leaflet-popup-content-wrapper{
      background:linear-gradient(180deg,#0f172a,#111827);
      color:var(--text);
      border:1px solid var(--border);
      border-radius:14px;
      box-shadow:0 10px 30px rgba(0,0,0,.35);
    }
    .leaflet-popup-tip{
      background:#111827;
      border:1px solid var(--border);
    }
    .leaflet-popup-content{
      margin:12px !important;
      min-width:250px;
    }

    .popup-card .name{
      margin:0 0 6px;
      font-size:16px;
      font-weight:700;
      color:#fff;
    }
    .popup-card .desc{
      margin:0 0 10px;
      font-size:13px;
      color:var(--muted);
      line-height:1.6;
    }
    .popup-row{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      margin:6px 0;
      font-size:13px;
    }
    .badge{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:4px 8px;
      border-radius:999px;
      font-size:12px;
      font-weight:700;
      border:1px solid var(--border);
      background:rgba(255,255,255,.03);
    }
    .open{ color:#86efac; border-color:rgba(34,197,94,.35); background:rgba(34,197,94,.08);}
    .closed{ color:#fca5a5; border-color:rgba(239,68,68,.35); background:rgba(239,68,68,.08);}

    .rating{
      color:#fbbf24;
      font-weight:700;
      letter-spacing:.3px;
    }
    .sub-ratings{
      margin-top:8px;
      padding-top:8px;
      border-top:1px dashed var(--border);
    }
    .sub-ratings .item{
      display:flex;
      justify-content:space-between;
      margin:4px 0;
      color:#d1d5db;
      font-size:12.5px;
    }

    /* Marker Ø¬Ù…ÙŠÙ„ */
    .fancy-pin{
      position:relative;
      width:34px;
      height:34px;
      transform:translate(-17px,-34px);
      border-radius:50% 50% 50% 0;
      background:linear-gradient(145deg,var(--primary),var(--primary-2));
      transform-origin:center;
      rotate:-45deg;
      box-shadow:
        0 6px 18px rgba(34,197,94,.45),
        inset 0 0 0 2px rgba(255,255,255,.18);
      transition:.2s ease;
    }
    .fancy-pin::before{
      content:"ğŸ½";
      position:absolute;
      inset:0;
      display:grid;
      place-items:center;
      rotate:45deg;
      font-size:14px;
      filter:drop-shadow(0 1px 2px rgba(0,0,0,.35));
    }
    .fancy-pin::after{
      content:"";
      position:absolute;
      width:12px;
      height:12px;
      background:rgba(255,255,255,.95);
      border-radius:50%;
      left:11px;
      top:11px;
      rotate:45deg;
      opacity:.16;
    }
    .fancy-pin:hover{
      scale:1.08;
      filter:brightness(1.05);
    }

    /* Ø¹Ù†ÙˆØ§Ù† ØµØºÙŠØ± Ø£Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø© */
    .map-title{
      position:fixed;
      top:14px;
      right:14px;
      z-index:1000;
      background:rgba(15,23,42,.8);
      backdrop-filter:blur(8px);
      color:#fff;
      border:1px solid var(--border);
      border-radius:12px;
      padding:10px 14px;
      font-weight:700;
      font-size:13px;
      box-shadow:0 6px 20px rgba(0,0,0,.25);
    }
  </style>
</head>
<body>
  <div class="map-title">ğŸ´ Ø£ÙØ¶Ù„ Ù…Ø·Ø§Ø¹Ù… Ø³ÙƒÙŠÙƒØ¯Ø©</div>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    // 1) Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø®Ø±ÙŠØ·Ø©
    const map = L.map("map", {
      center: [36.8796, 6.9065],
      zoom: 14,
      zoomControl: true,
      scrollWheelZoom: true,
      fadeAnimation: true,
      zoomAnimation: true
    });

    L.tileLayer("https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png", {
      attribution: "&copy; OpenStreetMap contributors &copy; CARTO",
      subdomains: "abcd",
      maxZoom: 20
    }).addTo(map);

    // 2) Ø£ÙŠÙ‚ÙˆÙ†Ø© Marker Ù…Ø®ØµØµØ©
    const FancyPin = L.DivIcon.extend({
      options: {
        className: "fancy-pin",
        iconSize: [34, 34],
        iconAnchor: [17, 34],
        popupAnchor: [0, -30]
      }
    });

    // 3) Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ø§Ø¹Ù… (ÙŠÙ…ÙƒÙ†Ùƒ Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¹Ø¯Ø¯ Ø¨Ø³Ù‡ÙˆÙ„Ø©)
    const restaurants = [
      {
        lat: 36.878, lng: 6.898,
        name: "Ù…Ø·Ø¹Ù… Ø§Ù„Ø±ÙŠÙ",
        description: "Ù…Ø·Ø¹Ù… Ø¹Ø§Ø¦Ù„ÙŠ Ù…Ø´Ù‡ÙˆØ± Ø¨Ø§Ù„Ù…Ø´Ø§ÙˆÙŠ ÙˆØ§Ù„Ø£Ø·Ø¨Ø§Ù‚ Ø§Ù„ØªÙ‚Ù„ÙŠØ¯ÙŠØ©.",
        rating: 9.0,
        food: 9.2, service: 8.7, cleanliness: 9.1, price: 8.8,
        status: "open",
        hours: "12:00 - 23:30"
      },
      {
        lat: 36.880, lng: 6.905,
        name: "Ù…Ø·Ø¹Ù… Ø§Ù„Ø¨Ù‡Ø¬Ø©",
        description: "Ø£ÙƒÙ„Ø§Øª Ø³Ø±ÙŠØ¹Ø© ÙˆØ¨ÙŠØªØ²Ø§ Ù…Ø¹ Ø¬Ù„Ø³Ø§Øª Ù…Ø±ÙŠØ­Ø©.",
        rating: 8.5,
        food: 8.6, service: 8.2, cleanliness: 8.4, price: 8.9,
        status: "open",
        hours: "11:00 - 00:00"
      },
      {
        lat: 36.882, lng: 6.910,
        name: "Ù…Ø·Ø¹Ù… Ø§Ù„Ø²Ù‡Ø±Ø§Ø¡",
        description: "Ù…ØªØ®ØµØµ ÙÙŠ Ø§Ù„Ø³Ù…Ùƒ Ø§Ù„Ø·Ø§Ø²Ø¬ ÙˆØ§Ù„Ù…Ø£ÙƒÙˆÙ„Ø§Øª Ø§Ù„Ø¨Ø­Ø±ÙŠØ©.",
        rating: 8.8,
        food: 9.1, service: 8.4, cleanliness: 8.8, price: 8.3,
        status: "closed",
        hours: "13:00 - 22:00"
      },
      {
        lat: 36.876, lng: 6.915,
        name: "Ù…Ø·Ø¹Ù… Ø³ÙƒÙŠÙƒØ¯Ø© Ø§ï¿½ï¿½Ù…Ø±ÙƒØ²ÙŠ",
        description: "ØªÙ†ÙˆØ¹ ÙƒØ¨ÙŠØ± ÙÙŠ Ø§Ù„Ø£Ø·Ø¨Ø§Ù‚ Ù…Ø¹ Ø®Ø¯Ù…Ø© Ø³Ø±ÙŠØ¹Ø©.",
        rating: 9.2,
        food: 9.3, service: 9.0, cleanliness: 9.1, price: 8.6,
        status: "open",
        hours: "10:30 - 23:00"
      },
      {
        lat: 36.874, lng: 6.900,
        name: "Ù…Ø·Ø¹Ù… Ø§Ù„Ø¨Ø­Ø±",
        description: "Ø¥Ø·Ù„Ø§Ù„Ø© Ø¬Ù…ÙŠÙ„Ø© ÙˆÙ‚Ø§Ø¦Ù…Ø© Ø¨Ø­Ø±ÙŠØ© Ù…Ù…ÙŠØ²Ø©.",
        rating: 8.7,
        food: 9.0, service: 8.1, cleanliness: 8.9, price: 8.0,
        status: "open",
        hours: "12:30 - 23:00"
      }
    ];

    // 4) ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ù„Ù†Ø¬ÙˆÙ…
    function stars(score){
      const rounded = Math.round(score / 2); // Ù…Ù† 10 Ø¥Ù„Ù‰ 5
      return "â˜…".repeat(rounded) + "â˜†".repeat(5 - rounded);
    }

    // 5) Ø¥Ù†Ø´Ø§Ø¡ Popup HTML
    function popupTemplate(r){
      const isOpen = r.status === "open";
      return `
        <div class="popup-card">
          <h3 class="name">${r.name}</h3>
          <p class="desc">${r.description}</p>

          <div class="popup-row">
            <span>Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø¹Ø§Ù…</span>
            <span class="rating">${stars(r.rating)} (${r.rating}/10)</span>
          </div>

          <div class="popup-row">
            <span>Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¹Ù…Ù„</span>
            <span>${r.hours}</span>
          </div>

          <div class="popup-row">
            <span>Ø§Ù„Ø­Ø§Ù„Ø©</span>
            <span class="badge ${isOpen ? "open" : "closed"}">
              ${isOpen ? "Ù…ÙØªÙˆØ­ Ø§Ù„Ø¢Ù†" : "Ù…ØºÙ„Ù‚ Ø­Ø§Ù„ÙŠØ§Ù‹"}
            </span>
          </div>

          <div class="sub-ratings">
            <div class="item"><span>Ø¬ÙˆØ¯Ø© Ø§Ù„Ø£ÙƒÙ„</span><strong>${r.food}/10</strong></div>
            <div class="item"><span>Ø§Ù„Ø®Ø¯Ù…Ø©</span><strong>${r.service}/10</strong></div>
            <div class="item"><span>Ø§Ù„Ù†Ø¸Ø§ÙØ©</span><strong>${r.cleanliness}/10</strong></div>
            <div class="item"><span>Ø§Ù„Ø³Ø¹Ø± Ù…Ù‚Ø§Ø¨Ù„ Ø§Ù„Ø¬ÙˆØ¯Ø©</span><strong>${r.price}/10</strong></div>
          </div>
        </div>
      `;
    }

    // 6) Ø±Ø³Ù… Ø§Ù„Ù…Ø§Ø±ÙƒØ±Ø§Øª
    restaurants.forEach((r) => {
      L.marker([r.lat, r.lng], { icon: new FancyPin() })
        .addTo(map)
        .bindPopup(popupTemplate(r), { maxWidth: 300 });
    });
  </script>
</body>
</html>
